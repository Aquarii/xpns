{% extends "base.html" %}
{% block content %}
<div class="container">
  <h1 class="my-4" style="text-align:center;">همه مخارج</h1>

  <!-- Filters -->
  <form method="get" class="row g-2" style="direction: rtl; margin-bottom: 1rem;">
    <div class="col-md-4">
      <label class="form-label">جستجو (عنوان/توضیحات)</label>
      <input type="text" name="q" value="{{ q }}" class="form-control" placeholder="مثلاً: شارژ آسانسور">
    </div>
    <div class="col-md-2">
      <label class="form-label">دوره</label>
      <input type="number" name="period" value="{{ period }}" class="form-control" placeholder="مثلاً 140407">
    </div>
    <div class="col-md-2">
      <label class="form-label">حداقل مبلغ</label>
      <input type="number" name="min_amount" value="{{ min_amount }}" class="form-control" placeholder="مثلاً 100000">
    </div>
    <div class="col-md-2">
      <label class="form-label">حداکثر مبلغ</label>
      <input type="number" name="max_amount" value="{{ max_amount }}" class="form-control" placeholder="مثلاً 5000000">
    </div>
    <div class="col-md-2 d-flex align-items-end">
      <button type="submit" class="btn btn-primary w-100">اعمال فیلتر</button>
    </div>
    <div class="col-12 mt-2">
      <a href="{{ url_for('view_expenses') }}">پاک کردن فیلترها</a>
    </div>
  </form>

  <!-- Results -->
  <table class="table table-striped table-bordered">
    <thead>
      <tr>
        <th style="text-align:center;">#</th>
        <th style="text-align:center;">مخارج</th>
        <th style="text-align:center;">دوره</th>
        <th style="text-align:center;">مبلغ (تومان)</th>
        <th style="text-align:center;">توضیحات</th>
      </tr>
    </thead>
    <tbody>
      {% for e in expenses %}
      <tr>
        <td style="text-align:center;">{{ e.expense_id }}</td>
        <td>{{ e.name }}</td>
        <td style="text-align:center;">{{ e.period }}</td>
        <td style="direction:ltr; text-align:right;">{{ '{:,}'.format(e.amount) }}</td>
        <td>{{ e.description or '-' }}</td>
      </tr>
      {% endfor %}
      {% if expenses|length == 0 %}
      <tr>
        <td colspan="5" style="text-align:center;">موردی یافت نشد.</td>
      </tr>
      {% endif %}
    </tbody>
  </table>

  <div style="text-align:center; margin-top:1rem;">
    <a href="{{ url_for('index') }}">بازگشت به صفحه اصلی</a>
  </div>
</div>
{% endblock %}
